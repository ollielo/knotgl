<!DOCTYPE html>
<html>
<head>
<title>KnotGL</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/jquery.gritter.css" />
<link rel="stylesheet" href="fontello/fontello-48c915cd.css" />
<link href="http://fonts.googleapis.com/css?family=Questrial|Yanone+Kaffeesatz|Nobile:400,700" rel="stylesheet" type="text/css">
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery.gritter.js"></script>
<script type="text/javascript" src="js/gl-matrix-min.js"></script>
<script type="text/javascript" src="js/Tween.js"></script>
<script type="text/javascript" src="js/RequestAnimationFrame.js"></script>
<script type="text/javascript" src="js/globals.js"></script>
<script type="text/javascript" src="js/knotgl-min.js"></script>
<script type="text/javascript">
var tween;
function init()
{
    window.mouse = {}
    window.mouse.position = {x: -1, y: -1};
    window.mouse.within = false;
    window.mouse.hot = false;
    window.pan = {x: 0};
    window.AppInit();
    layout();
}
function layout()
{
    height = parseInt($("#wideband").css('height'));
    width = height*768/1024;
    $("#wideband").css("width", width);

    bodyWidth = parseInt($("body").css('width'));
    $("#wideband").css("left", bodyWidth / 2 - width / 2);

    width = window.pan.width = parseInt($("#canvaspage").css('width'));
    height = parseInt($("#canvaspage").css('height'));
    c = $("canvas").get(0);
    c.clientWidth = width;
    c.width = c.clientWidth;
    c.clientHeight = height;
    c.height = c.clientHeight;
    this.renderer.width = width;
    this.renderer.height = height;

    updateTween();
}
function inArrow(element)
{
    q = $("#" + element.id)
    q.css('color', '#cdf');
    window.mouse.hot = 1;
}
function outArrow(element)
{
    q = $("#" + element.id)
    q.css({'color' : ''});
    window.mouse.hot = false;
}
function clickArrow(element)
{
    panTarget = element.id == "leftarrow" ? window.pan.width : 0
    tween = new TWEEN.Tween(window.pan)
        .to({x: panTarget}, 1000)
        .easing(TWEEN.Easing.Bounce.Out)
        .onUpdate(updateTween);
    tween.start()
}
function updateTween()
{
    w = parseInt($("#canvaspage").css('width'));
    h = parseInt($("#canvaspage").css('height'));
    $("#leftpage").css("left", -w + window.pan.x);
    $("#leftpage").css("width", w - 40);
    $("#rightpage").css("left", 0 + window.pan.x);
    $("#rightpage").css("width", w - 40);
}
function mouseMove(event)
{
    var p = $('#wideband').position();
    var x = window.mouse.position.x = event.clientX - p.left;
    var y = window.mouse.position.y = event.clientY - p.top;
    window.mouse.within = 1;
}
function mouseClick(event)
{
    mouseMove(event);
    window.MouseClick();
}
function mouseLeave(event)
{
    window.mouse.position.x = -1;
    window.mouse.position.y = -1;
    window.mouse.within = false;
}
</script>
</head>

<body style="margin:0;background-color:#ccc" onresize="layout()" onload="init()">
  <div id="wideband"
       onclick="mouseClick(event)"
       onmousemove="mouseMove(event)"
       onmouseout="mouseLeave()">

    <!-- CANVAS PAGE -->
    <div id="canvaspage">
      <canvas>
      </canvas>
    </div>

    <!-- LEFT PAGE -->
    <div id="leftpage" class="scrollpage">
      <h1>Left page.</h1>
      <p>
        Call me Ishmael.  Some years ago - never mind how long precisely - having little or no money in my purse, and nothing particular to interest me on shore...
      </p>
      <div style="right: -10px"
           id="rightarrow"
           onmouseover="inArrow(this)"
           onmouseout="outArrow(this)"
           onclick="clickArrow(this)"
           class="arrow">
          <span class="icon-right"></span>
      </div>
    </div>

    <!-- RIGHT PAGE -->
    <div id="rightpage" class="scrollpage">

      <div id="crossings"   class="numeral" style="bottom:40px; right:50px;font-size:100px;">&nbsp;</div>
      <div id="superscript" class="numeral" style="bottom:110px;right:20px;font-size: 50px;">&nbsp;</div>
      <div id="subscript"   class="numeral" style="bottom: 30px;right:20px;font-size: 50px;">&nbsp;</div>

      <div style="left: -10px"
           id="leftarrow"
           onmouseover="inArrow(this)"
           onmouseout="outArrow(this)"
           onclick="clickArrow(this)"
           class="arrow">
        <span class="icon-left"></span>
        <span class="icon-github"></span>
        <span class="icon-cog"></span> <!-- There should be an option to remove the hot pinkness -->
        <span class="icon-link"></span>
      </div>
    </div>

  </div>
</body>
