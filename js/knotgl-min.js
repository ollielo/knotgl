(function(){var t,n,u,v,w,s,z,i,x;i="undefined"!==typeof exports&&null!==exports?exports:this;i.AppInit=function(){var g,b,d;g=$("canvas").get(0).getContext("experimental-webgl",{antialias:!0});g.getExtension("OES_texture_float")||glerr("Your browser does not support floating-point textures.");g.getExtension("OES_standard_derivatives")||glerr("Your browser does not support GLSL derivatives.");d=parseInt($("#overlay").css("width"));b=parseInt($("#overlay").css("height"));return i.renderer=new i.Renderer(g,
d,b)};i.OnKeyDown=function(g){"left"===g&&i.renderer.changeSelection(-1);if("right"===g)return i.renderer.changeSelection(1)};i="undefined"!==typeof exports&&null!==exports?exports:this;i.links=[["0.1"],["3.1",[3042,47]],["4.1",[1375,69]],["5.1",[7357,69]],["5.2",[1849,81]],["6.1",[1534,96]],["6.2",[0,82]],["6.3",[10652,85]],["7.1",[7845,94]],["7.2",[5595,86]],["7.3",[190,122]],["7.4",[3640,102]],["7.5",[1751,98]],["7.6",[5020,102]],["7.7",[9660,91]],["8.1",[1279,96]],["8.2",[9751,108]],["8.3",[2817,
112]],["8.4",[3938,105]],["8.5",[4043,105]],["8.6",[4623,90]],["8.7",[1191,88]],["8.8",[5681,100]],["8.9",[1930,98]],["8.10",[9031,85]],["8.11",[1444,90]],["8.12",[4828,94]],["8.13",[6231,90]],["8.14",[885,98]],["8.15",[9574,86]],["8.16",[4148,85]],["8.17",[312,81]],["8.18",[2243,97]],["8.19",[6321,86]],["8.20",[7529,88]],["8.21",[686,89]],["9.1",[7013,102]],["9.2",[10544,108]],["9.3",[4922,98]],["9.4",[3322,89]],["9.5",[3411,114]],["9.6",[8182,98]],["9.7",[592,94]],["9.8",[10353,91]],["9.9",[2140,
103]],["9.10",[8392,112]],["9.11",[9349,120]],["9.12",[2929,113]],["9.13",[9116,123]],["9.14",[3089,102]],["9.15",[7939,116]],["9.16",[5462,133]],["9.17",[10242,111]],["9.18",[82,108]],["9.19",[5122,118]],["9.20",[7725,120]],["9.21",[486,106]],["9.22",[1630,121]],["9.23",[2436,113]],["9.24",[775,110]],["9.25",[6601,102]],["9.26",[3525,115]],["9.27",[6407,89]],["9.28",[7426,103]],["9.29",[8280,112]],["9.30",[5781,111]],["9.31",[6703,120]],["9.32",[8055,127]],["9.33",[7227,130]],["9.34",[4713,115]],
["9.35",[3191,131]],["9.36",[5240,119]],["0.2.1"],["2.2.1",[2648,36],[2684,36]],["4.2.1",[10161,39],[10200,42]],["5.2.1",[8728,38],[8766,39]],["6.2.1",[8931,49],[8980,51]],["6.2.2",[2340,47],[2387,49]],["6.2.3",[3742,41],[3783,54]],["7.2.1",[9859,44],[9903,55]],["7.2.2",[393,45],[438,48]],["7.2.3",[6928,39],[6967,46]],["7.2.4",[6496,77],[6573,28]],["7.2.5",[5892,45],[5937,68]],["7.2.6",[6823,27],[6850,78]],["7.2.7",[10057,78],[10135,26]],["7.2.8",[9239,43],[9282,67]],["8.2.1",[7115,58],[7173,54]],
["8.2.2",[6005,53],[6058,59]],["8.2.3",[8504,42],[8546,63]],["8.2.4",[4357,50],[4407,57]],["8.2.5",[9958,51],[10009,48]],["8.2.6",[10444,46],[10490,54]],["8.2.7",[5359,47],[5406,56]],["8.2.8",[1097,50],[1147,44]],["8.2.9",[2028,42],[2070,70]],["8.2.10",[4233,96],[4329,28]],["8.2.11",[6117,93],[6210,21]],["0.3.1"],["6.3.1",[3837,37],[3874,31],[3905,33]],["6.3.2",[9469,38],[9507,34],[9541,33]],["6.3.3",[2720,35],[2755,30],[2785,32]],["7.3.1",[7617,44],[7661,33],[7694,31]],["8.3.1",[8805,45],[8850,49],
[8899,32]],["8.3.2",[8609,45],[8654,48],[8702,26]],["8.3.3",[983,43],[1026,36],[1062,35]],["8.3.4",[4464,28],[4492,29],[4521,102]],["8.3.5",[2549,26],[2575,29],[2604,44]]];i="undefined"!==typeof exports&&null!==exports?exports:this;t=1;n=function(){function g(b,d,a){this.gl=b;this.width=d;this.height=a;this.radiansPerSecond=3.0E-4;this.transitionMilliseconds=750;this.spinning=!0;this.style=t;this.sketchy=!0;this.theta=0;this.vbos={};this.programs={};this.selectionIndex=0;this.tubeGen=new i.TubeGenerator;
this.tubeGen.polygonSides=10;this.tubeGen.b\u00e9zierSlices=3;this.tubeGen.tangentSmoothness=3;this.compileShaders();this.gl.disable(this.gl.CULL_FACE);this.gl.getError()!==this.gl.NO_ERROR&&glerr("OpenGL error during init");this.downloadSpines()}g.name="Renderer";g.prototype.onDownloadComplete=function(b){this.spines=new Float32Array(b.centerlines);this.vbos.spines=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbos.spines);this.gl.bufferData(this.gl.ARRAY_BUFFER,this.spines,
this.gl.STATIC_DRAW);this.gl.getError()!==this.gl.NO_ERROR&&glerr("Error when trying to create spine VBO");toast("downloaded "+this.spines.length/3+" verts of spine data");this.genVertexBuffers();return this.render()};g.prototype.changeSelection=function(b){var d,a;d=this.selectionIndex;a=d+b;if(!(a>=this.links.length||0>a))if(b=this.links[d].iconified,0===b)this.selectionIndex=a,i.outgoing=(new TWEEN.Tween(this.links[d])).to({iconified:1},0.5*this.transitionMilliseconds).easing(TWEEN.Easing.Quartic.Out),
i.incoming=(new TWEEN.Tween(this.links[a])).to({iconified:0},this.transitionMilliseconds).easing(TWEEN.Easing.Bounce.Out),i.incoming.start(),i.outgoing.start();else return this.selectionIndex=a,this.links[d].iconified=1,this.links[a].iconified=b,i.incoming.replace(this.links[a])};g.prototype.downloadSpines=function(){var b;b=new Worker("js/downloader.js");b.renderer=this;b.onmessage=function(b){return this.renderer.onDownloadComplete(b.data)};return b.postMessage(document.URL+"data/centerlines.bin")};
g.prototype.compileShaders=function(){var b,d,a,e,k,c;k=i.shaders;c=[];for(a in k)d=k[a],"source"!==a&&(b=d.keys,e=b[0],b=b[1],c.push(this.programs[a]=this.compileProgram(e,b,d.attribs,d.uniforms)));return c};g.prototype.render=function(){var b,d,a,e,k,c,h;window.requestAnimationFrame(function(){return i.renderer.render()},$("canvas").get(0));TWEEN.update();b=(new Date).getTime();null!=this.previousTime&&(d=b-this.previousTime,this.spinning&&(this.theta+=this.radiansPerSecond*d));this.previousTime=
b;this.projection=mat4.perspective(45,this.width/this.height,5,90);d=mat4.lookAt([0,-5,5],[0,0,0],[0,1,0]);b=mat4.create();this.modelview=mat4.create();mat4.identity(b);mat4.rotateX(b,0.785);mat4.rotateY(b,this.theta);mat4.multiply(d,b,this.modelview);this.normalMatrix=mat4.toMat3(this.modelview);d=a=0;for(c=this.links.length;0<=c?a<c:a>c;d=0<=c?++a:--a){h=this.links[d];e=0;for(k=h.length;e<k;e++)b=h[e],this.renderKnot(b,d)}if(this.gl.getError()!==this.gl.NO_ERROR)return glerr("Render")};g.prototype.renderKnot=
function(b,d){var a,e,k,c,h,j,f,r,g,m,l,i;this.gl.setColor=function(a,c){return this.uniform4f(a,b.color[0],b.color[1],b.color[2],c)};f=this.width/9;64>f&&(f=64);128<f&&(f=128);a=(9*f-this.width)/4;0>a&&(a=0);e=0.5*(this.width-9*(f-a));j=f*this.height/this.width;e+=(f-a)*d;k=this.links[d].iconified;a=0.25+0.75*k;this.gl.viewport(e,this.height-j,f,j);this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);c=this.programs.wireframe;this.gl.useProgram(c);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
this.vbos.spines);this.gl.enableVertexAttribArray(POSITION);this.gl.vertexAttribPointer(POSITION,3,this.gl.FLOAT,!1,12,0);this.gl.uniformMatrix4fv(c.projection,!1,this.projection);this.gl.uniformMatrix4fv(c.modelview,!1,this.modelview);this.gl.uniform1f(c.scale,this.tubeGen.scale);this.gl.uniform4f(c.color,0,0,0,a);r=b.centerline;h=r[0];r=r[1];this.gl.enable(this.gl.DEPTH_TEST);this.gl.lineWidth(2);for(g=l=-1;1>=l;g=l+=2)for(m=i=-1;1>=i;m=i+=2)this.gl.uniform2f(c.offset,g,m),this.gl.uniform1f(c.depthOffset,
0),this.gl.drawArrays(this.gl.LINE_LOOP,h,r);this.gl.enable(this.gl.BLEND);this.gl.lineWidth(2);this.gl.setColor(c.color,a);this.gl.uniform2f(c.offset,0,0);this.gl.uniform1f(c.depthOffset,-0.5);this.gl.drawArrays(this.gl.LINE_LOOP,h,r);this.gl.disableVertexAttribArray(POSITION);this.gl.viewport(0,0,this.width,this.height);c.color[3]=1;a=1-k;this.gl.viewport((1-a)*e,(1-a)*(this.height-j),a*this.width+(1-a)*f,a*this.height+(1-a)*j);c=this.programs.solidmesh;this.gl.enable(this.gl.DEPTH_TEST);this.gl.useProgram(c);
this.gl.setColor(c.color);this.gl.uniformMatrix4fv(c.projection,!1,this.projection);this.gl.uniformMatrix4fv(c.modelview,!1,this.modelview);this.gl.uniformMatrix3fv(c.normalmatrix,!1,this.normalMatrix);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.tube);this.gl.enableVertexAttribArray(POSITION);this.gl.enableVertexAttribArray(NORMAL);this.gl.vertexAttribPointer(POSITION,3,this.gl.FLOAT,!1,24,0);this.gl.vertexAttribPointer(NORMAL,3,this.gl.FLOAT,!1,24,12);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,
b.triangles);this.style===t&&(this.gl.enable(this.gl.POLYGON_OFFSET_FILL),this.gl.polygonOffset(-1,12));this.gl.drawElements(this.gl.TRIANGLES,b.triangles.count,this.gl.UNSIGNED_SHORT,0);this.gl.disableVertexAttribArray(POSITION);this.gl.disableVertexAttribArray(NORMAL);this.gl.disable(this.gl.POLYGON_OFFSET_FILL);this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);c=this.programs.wireframe;this.gl.useProgram(c);this.gl.uniformMatrix4fv(c.projection,!1,this.projection);
this.gl.uniformMatrix4fv(c.modelview,!1,this.modelview);this.gl.uniform1f(c.scale,1);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.tube);this.gl.enableVertexAttribArray(POSITION);this.gl.vertexAttribPointer(POSITION,3,this.gl.FLOAT,!1,24,0);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,b.wireframe);0===this.style?(this.gl.lineWidth(1),this.gl.uniform1f(c.depthOffset,-0.01),this.gl.uniform4f(c.color,0,0,0,0.75),this.gl.drawElements(this.gl.LINES,b.wireframe.count,this.gl.UNSIGNED_SHORT,0)):2===this.style?
(this.gl.lineWidth(1),this.gl.uniform1f(c.depthOffset,-0.01),this.gl.uniform4f(c.color,0,0,0,0.75),this.gl.drawElements(this.gl.LINES,b.wireframe.count/2,this.gl.UNSIGNED_SHORT,b.wireframe.count)):(this.gl.lineWidth(2),this.gl.uniform1f(c.depthOffset,0.01),this.gl.uniform4f(c.color,0,0,0,1),this.gl.drawElements(this.gl.LINES,b.wireframe.count,this.gl.UNSIGNED_SHORT,0),this.sketchy&&(this.gl.lineWidth(1),this.gl.uniform4f(c.color,0.1,0.1,0.1,1),this.gl.uniform1f(c.depthOffset,-0.01),this.gl.drawElements(this.gl.LINES,
b.wireframe.count/2,this.gl.UNSIGNED_SHORT,b.wireframe.count)));return this.gl.disableVertexAttribArray(POSITION)};g.prototype.getLink=function(b){var d,a,e,k,c;k=i.links;c=[];a=0;for(e=k.length;a<e;a++)d=k[a],d[0]===b&&c.push(d.slice(1));return c[0]};g.prototype.genVertexBuffers=function(){var b,d,a,e,k;this.links=[];k="7.2.3 7.2.4 7.2.5 7.2.6 7.2.7 7.2.8 8.2.1 8.2.2 8.2.3".split(" ");a=0;for(e=k.length;a<e;a++){b=k[a];var c=d=void 0,h=void 0,j=void 0,h=this.getLink(b),j=[];d=0;for(c=h.length;d<
c;d++)b=h[d],j.push(this.tessKnot(b));d=j;d[0].color=[1,1,1,0.75];1<d.length&&(d[1].color=[0.25,0.5,1,0.75]);2<d.length&&(d[2].color=[1,0.5,0.25,0.75]);d.iconified=1;this.links.push(d)}return this.links[0].iconified=0};g.prototype.tessKnot=function(b){var d,a,e,k,c,h,j,f,g,i,m;d=this.tubeGen.getKnotPath(this.spines.subarray(3*b[0],3*b[0]+3*b[1]));j=this.tubeGen.generateTube(d);a=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a);this.gl.bufferData(this.gl.ARRAY_BUFFER,j,this.gl.STATIC_DRAW);
console.log("Tube positions has "+j.length/3+" verts.");i=a;c=d.length/3-1;f=this.tubeGen.polygonSides;j=new Uint16Array(4*c*f);h=[0,0];a=h[0];for(h=h[1];a<c*(f+1);){for(e=0;e<f;)k=j.subarray(h+2,h+4),k[0]=a+e,k[1]=a+e+f+1,e=[h+2,e+1],h=e[0],e=e[1];a+=f+1}for(a=0;a<c*(f+1);){for(e=0;e<f;)k=j.subarray(h+0,h+2),k[0]=a+e,k[1]=a+e+1,e=[h+2,e+1],h=e[0],e=e[1];a+=f+1}a=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,j,this.gl.STATIC_DRAW);
c=a;c.count=j.length;console.log("Tube wireframe has "+j.length+" indices for "+f+" sides and "+(d.length/3-1)+" polygons.");j=new Uint16Array(6*d.length/3*f);e=[0,0,0];a=e[0];h=e[1];for(m=e[2];++a<d.length/3;){for(e=-1;++e<f;)k=(e+1)%f,g=j.subarray(h+0,h+3),g[0]=m+k+f+1,g[1]=m+k,g[2]=m+e,g=j.subarray(h+3,h+6),g[0]=m+e,g[1]=m+e+f+1,g[2]=m+k+f+1,h+=6;m+=f+1}a=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,j,this.gl.STATIC_DRAW);
d=a;d.count=j.length;return{centerline:b,tube:i,wireframe:c,triangles:d}};g.prototype.compileProgram=function(b,d,a,e){var k,c,h,j,f;k=function(a,b,c){a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))return $.gritter.add({title:"GLSL Error: "+b,text:a.getShaderInfoLog(c)})};c=i.shaders.source[b];f=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(f,c);k(this.gl,b,f);h=i.shaders.source[d];c=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(c,h);k(this.gl,
d,c);k=this.gl.createProgram();this.gl.attachShader(k,f);this.gl.attachShader(k,c);for(j in a)f=a[j],this.gl.bindAttribLocation(k,f,j);this.gl.linkProgram(k);this.gl.getProgramParameter(k,this.gl.LINK_STATUS)||glerr("Could not link "+b+" with "+d);for(j in e)f=e[j],k[f]=this.gl.getUniformLocation(k,j);return k};return g}();i.Renderer=n;n=function(){var g,b,d,a;d=["sin","cos","pow","abs"];a=[];g=0;for(b=d.length;g<b;g++)s=d[g],a.push(Math[s]);return a}();x=n[0];v=n[1];w=vec3.dot;u=2*Math.PI;i="undefined"!==
typeof exports&&null!==exports?exports:this;i.shaders={solidmesh:{keys:["VS-Scene","FS-Scene"],attribs:{Position:POSITION,Normal:NORMAL},uniforms:{Projection:"projection",Modelview:"modelview",NormalMatrix:"normalmatrix",Color:"color"}},wireframe:{keys:["VS-Wireframe","FS-Wireframe"],attribs:{Position:POSITION},uniforms:{Projection:"projection",Modelview:"modelview",DepthOffset:"depthOffset",Offset:"offset",Color:"color",Scale:"scale"}},vignette:{keys:["VS-Vignette","FS-Vignette"],attribs:{VertexID:VERTEXID},
uniforms:{Viewport:"viewport"}}};i.shaders.source={};i.shaders.source["VS-Scene"]="attribute vec4 Position;\nattribute vec3 Normal;\nuniform mat4 Modelview;\nuniform mat4 Projection;\nuniform mat3 NormalMatrix;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvoid main(void)\n{\n    vPosition = Position.xyz;\n    vNormal = NormalMatrix * Normal;\n    gl_Position = Projection * Modelview * Position;\n}";i.shaders.source["VS-Wireframe"]="attribute vec4 Position;\nuniform mat4 Modelview;\nuniform mat4 Projection;\nuniform float DepthOffset;\nuniform float Scale;\nuniform vec2 Offset;\nvoid main(void)\n{\n    vec4 p = Position;\n    p.xyz *= Scale;\n    gl_Position = Projection * Modelview * p;\n    gl_Position.z += DepthOffset;\n    gl_Position.xy += Offset * 0.15;\n}";
i.shaders.source["FS-Wireframe"]="precision highp float;\nprecision highp vec3;\nuniform vec4 Color;\nvoid main()\n{\n    gl_FragColor = Color;\n}";i.shaders.source["FS-Scene"]="precision highp float;\nprecision highp vec3;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvec3 LightPosition = vec3(0.25, 0.5, 1.0);\nvec3 AmbientMaterial = vec3(0.04, 0.04, 0.04);\nvec3 SpecularMaterial = vec3(0.25, 0.25, 0.25);\nvec3 FrontMaterial = vec3(0.25, 0.5, 0.75);\nvec3 BackMaterial = vec3(0.75, 0.75, 0.7);\nfloat Shininess = 50.0;\n\nuniform vec4 Color;\n\nvoid main()\n{\n    vec3 N = normalize(vNormal);\n    if (!gl_FrontFacing)\n        N = -N;\n\n    vec3 L = normalize(LightPosition);\n    vec3 Eye = vec3(0, 0, 1);\n    vec3 H = normalize(L + Eye);\n\n    float df = max(0.0, dot(N, L));\n    float sf = max(0.0, dot(N, H));\n    sf = pow(sf, Shininess);\n\n    vec3 P = vPosition;\n    vec3 I = normalize(P);\n    float cosTheta = abs(dot(I, N));\n    float fresnel = 1.0 - clamp(pow(1.0 - cosTheta, 0.125), 0.0, 1.0);\n\n    vec3 color = !gl_FrontFacing ? FrontMaterial : BackMaterial;\n    color *= Color.rgb;\n    vec3 lighting = AmbientMaterial + df * color;\n    if (gl_FrontFacing)\n        lighting += sf * SpecularMaterial;\n\n    lighting += fresnel;\n    gl_FragColor = vec4(lighting,1);\n}";
i.shaders.source["VS-Vignette"]="attribute vec2 VertexID;\nvoid main(void)\n{\n    vec2 p = 3.0 - 4.0 * VertexID;\n    gl_Position = vec4(p, 0, 1);\n}";i.shaders.source["FS-Vignette"]="precision highp float;\nprecision highp vec2;\n\nuniform vec2 Viewport;\nvoid main()\n{\n    vec2 c = gl_FragCoord.xy / Viewport;\n    float f = 1.0 - 0.5 * pow(distance(c, vec2(0.5)), 1.5);\n    gl_FragColor = vec4(f, f, f, 1);\n    gl_FragColor.rgb *= vec3(0.867, 0.18, 0.447); // Hot Pink!\n}";i="undefined"!==typeof exports&&
null!==exports?exports:this;n=function(){function g(){this.scale=0.15;this.tangentSmoothness=this.b\u00e9zierSlices=3;this.polygonSides=9;this.radius=0.07}g.name="TubeGenerator";g.prototype.getKnotPath=function(b){var d,a,e,k,c,h,j,f,g,i,m,l,p,o,n,q,y;i=this.b\u00e9zierSlices;g=new Float32Array(b.length*i+3);h=[0,0];k=h[0];for(h=h[1];k<b.length+3;){e=function(){var a,c,d,e;d=[0,2,3,5,6,8];e=[];a=0;for(c=d.length;a<c;a++)j=d[a],e.push((k+j)%b.length);return e}();d=b.subarray(e[0],e[1]+1);a=b.subarray(e[2],
e[3]+1);e=b.subarray(e[4],e[5]+1);l=vec3.create(d);n=vec3.create(a);vec3.lerp(l,a,0.5);vec3.lerp(n,e,0.5);p=vec3.create(l);o=vec3.create(n);vec3.lerp(p,a,1/3);vec3.lerp(o,a,1/3);a=d=1/(i+1);for(q=0;0<=i?q<i:q>i;0<=i?++q:--q){e=1-a;e=[e*e*e,3*e*e*a,3*e*a*a,a*a*a];f=function(){var a,b,c,d;c=[l,p,o,n];d=[];a=0;for(b=c.length;a<b;a++)m=c[a],d.push(vec3.create(m));return d}();for(c=y=0;4>y;c=++y)vec3.scale(f[c],e[c]);f=f.reduce(function(a,b){return vec3.add(a,b)});vec3.scale(f,this.scale);g.set(f,h);h+=
3;if(h>=g.length)return console.log("B\u00e9zier: generated "+h/3+" points from "+b.length/3+" control points."),g;a+=d}k+=3}};g.prototype.generateTube=function(b){var d,a,e,k,c,h,j,f,g,i,m,l,p,o,n,q;i=this.polygonSides;h=this.generateFrames(b);c=b.length/3;g=new Float32Array(6*c*(i+1));l=[0,0];j=l[0];f=l[1];l=vec3.create();for(m=this.radius;j<c;){o=0;e=function(){var b,c;c=[];for(a=b=0;2>=b;a=++b)c.push(h[a].subarray(3*j,3*j+3));return c}();e=function(){var b,c,f;f=[];b=0;for(c=e.length;b<c;b++)d=
e[b],f.push(function(){var b,c;c=[];for(a=b=0;2>=b;a=++b)c.push(d[a]);return c}());return f}();e=e.reduce(function(a,b){return a.concat(b)});e=mat3.create(e);p=0;for(k=u/i;o<i+1;)n=m*v(p),q=m*x(p),mat3.multiplyVec3(e,[n,q,0],l),l[0]+=b[3*j+0],l[1]+=b[3*j+1],l[2]+=b[3*j+2],g.set(l,f),p=[f+6,o+1,p+k],f=p[0],o=p[1],p=p[2];j++}console.log("GenerateTube: generated "+f+" vertices from a centerline with "+c+" nodes.");f=[0,0];j=f[0];f=f[1];m=vec3.create();for(k=vec3.create();j<c;){for(o=0;o<i+1;)l[0]=g[f+
0],l[1]=g[f+1],l[2]=g[f+2],k[0]=b[3*j+0],k[1]=b[3*j+1],k[2]=b[3*j+2],vec3.direction(l,k,m),g.set(m,f+3),o=[f+6,o+1],f=o[0],o=o[1];j++}return g};g.prototype.generateFrames=function(b){var d,a,e,g,c,h,j,f,i,n,m,l;d=b.length/3;a=new Float32Array(3*d);e=new Float32Array(3*d);g=new Float32Array(3*d);for(c=-1;++c<d;)h=(c+1+this.tangentSmoothness)%(d-1),m=b.subarray(3*c,3*c+3),l=b.subarray(3*h,3*h+3),i=g.subarray(3*c,3*c+3),vec3.direction(m,l,i);f=function(){var a,b;b=[];for(a=0;2>=a;++a)b.push(vec3.create());
return b}();j=f[0];i=f[1];m=f[2];c=function(){var a,b;b=[];for(a=0;2>=a;++a)b.push(vec3.create());return b}();f=c[0];n=c[1];l=c[2];vec3.set(g.subarray(0,3),m);z(m,j);vec3.cross(m,j,i);vec3.normalize(j);vec3.normalize(i);vec3.set(j,a.subarray(0,3));vec3.set(i,e.subarray(0,3));h=[0,1];c=h[0];h=h[1];h=[j,i,m];j=h[0];for(i=h[2];c<d-1;)h=c+1,m=b.subarray(3*c,3*c+3),l=b.subarray(3*h,3*h+3),i=g.subarray(3*c,3*c+3),l=g.subarray(3*h,3*h+3),vec3.cross(l,j,n),vec3.normalize(n),vec3.cross(n,l,f),vec3.set(f,a.subarray(3*
h,3*h+3)),vec3.set(n,e.subarray(3*h,3*h+3)),vec3.set(f,j),++c;return[a,e,g]};return g}();i.TubeGenerator=n;u=2*Math.PI;n=function(){var g,b,d,a;d=["sin","cos","pow","abs"];a=[];g=0;for(b=d.length;g<b;g++)s=d[g],a.push(Math[s]);return a}();x=n[0];v=n[1];w=vec3.dot;z=function(g,b){var d;d=vec3.create([1,0,0]);vec3.cross(g,d,b);0.01>w(b,b)&&(vec3.set(d,[0,1,0]),vec3.cross(g,d,b));return vec3.normalize(b)}}).call(this);
