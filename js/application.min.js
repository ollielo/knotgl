(function(){var p,h,c,i,q,k,l,g,b,j,e,m,n,o;b="undefined"!==typeof exports&&null!==exports?exports:this;h=i=!1;e=c=null;g=utility.clone(metadata.ExpandedSizes);$(document).ready(function(){var a,d,f,e;a=$("canvas").get(0);d=a.getContext("experimental-webgl",{antialias:!0});e=parseInt($("#overlay").css("width"));f=parseInt($("#overlay").css("height"));c=new b.Display(d,e,f);l();p();return window.requestAnimationFrame(m,a)});b.StartNumeralAnimation=function(){var a,b;if(!h&&!i)return b=0.25*c.transitionMilliseconds,
a=(new TWEEN.Tween(g)).to(metadata.CollapsedSizes,b).easing(TWEEN.Easing.Quintic.In).onUpdate(n).onComplete(function(){return h=!1}),b=(new TWEEN.Tween(g)).to(metadata.ExpandedSizes,b).easing(TWEEN.Easing.Quintic.In).onUpdate(n).onComplete(function(){return i=!1}),h=i=!0,a.chain(b),a.start()};m=function(){var a,d;window.requestAnimationFrame(m,$("canvas").get(0));TWEEN.update();h||(a=c.getCurrentLinkInfo(),$("#crossings").text(a.crossings),$("#subscript").text(a.index),$("#superscript").text(a.numComponents));
0===b.pageIndex&&(a=c.gallery.links.length,b.mouse.moved&&(d=c.height/a,d=Math.floor(b.mouse.position.y/d),d>=a&&(d=null),$("#grasshopper").is(":hover")&&(d=-1),c.highlightRow=d),$("#highlight-row").css("visibility","visible"),a=c.highlightRow*c.height/a,$("#highlight-row").css("top",a));a=c.hotMouse||b.mouse.hot||0===b.pageIndex?"pointer":"";$("#rightpage").css({cursor:a});$("#leftpage").css({cursor:a});c.ready&&c.render();return b.mouse.moved=!1};p=function(){$(window).resize(function(){return l()});
$(document).keydown(function(a){38===a.keyCode&&c.moveSelection(0,-1);40===a.keyCode&&c.moveSelection(0,1);37===a.keyCode&&c.moveSelection(-1,0);39===a.keyCode&&c.moveSelection(1,0);32===a.keyCode&&j();if(83===a.keyCode)return q()});$(".arrow").mouseover(function(){$(this).css("color","#385fa2");return b.mouse.hot=!0});$(".arrow").mouseout(function(){$(this).css({color:""});return b.mouse.hot=!1});$(".arrow").click(function(){return j()});$("#grasshopper").click(function(a){return a.stopPropagation()});
$("#wideband").mousemove(function(a){var d;d=$(this).position();b.mouse.position.x=a.clientX-d.left;b.mouse.position.y=a.clientY-d.top;b.mouse.within=1;return b.mouse.moved=!0});$("#wideband").click(function(a){var d;d=$(this).position();b.mouse.position.x=a.clientX-d.left;b.mouse.position.y=a.clientY-d.top;b.mouse.within=1;c.click();0===b.pageIndex&&null==e&&null!=c.highlightRow&&(c.changeSelection(c.gallery.i,c.highlightRow),j())});return $("#wideband").mouseout(function(){b.mouse.position.x=-1;
b.mouse.position.y=-1;return b.mouse.within=!1})};q=function(){var a;a=$("canvas").get(0);c.render();a=a.toDataURL("image/png");window.open(a,"_blank");return window.focus()};n=function(){$("#crossings").css("font-size",g.crossings);$("#superscript").css("font-size",g.numComponents);return $("#subscript").css("font-size",g.index)};k=function(a){var b;b=parseInt($("#canvaspage").css("width"));return 1===a?0:b};o=function(){var a;a=parseInt($("#canvaspage").css("width"));parseInt($("#canvaspage").css("height"));
$("#leftpage").css("left",-a+b.pan.x);$("#leftpage").css("width",a);$("#rightpage").css("left",0+b.pan.x);return $("#rightpage").css("width",a)};l=function(){var a,d,f;d=parseInt($("#wideband").css("height"));f=768*d/1024;$("#wideband").css("width",f);a=parseInt($("body").css("width"));$("#wideband").css("left",a/2-f/2);f=parseInt($("#canvaspage").css("width"));null!=e&&e.stop();d=parseInt($("#canvaspage").css("height"));a=$("canvas").get(0);a.clientWidth=f;a.width=a.clientWidth;a.clientHeight=d;
a.height=a.clientHeight;c.width=f;c.height=d;b.pan.x=k(b.pageIndex);return o()};j=function(){var a;if(null==e)return b.pageIndex=1-b.pageIndex,a=k(b.pageIndex),e=(new TWEEN.Tween(b.pan)).to({x:a},1E3).easing(TWEEN.Easing.Bounce.Out).onUpdate(o).onComplete(function(){return e=null}),e.start()};b.pageIndex=1;b.pan={x:0};b.mouse={position:{x:-1,y:-1},within:!1,hot:!1,moved:!1}}).call(this);
