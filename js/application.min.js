(function(){var l,m,n,g,h,a,f,i,j,k;a="undefined"!==typeof exports&&null!==exports?exports:this;$(function(){var b,c,d,e;b=$("canvas").get(0);c=b.getContext("experimental-webgl",{antialias:!0});c.getExtension("OES_texture_float")||glerr("Your browser does not support floating-point textures.");c.getExtension("OES_standard_derivatives")||glerr("Your browser does not support GLSL derivatives.");e=parseInt($("#overlay").css("width"));d=parseInt($("#overlay").css("height"));a.display=new a.Display(c,
e,d);h();l();return window.requestAnimationFrame(i,b)});a.AnimateNumerals=function(){var b,c,d,e;if(!c&&!e)return c=0.25*a.display.transitionMilliseconds,b=(new TWEEN.Tween(a.numeralSizes)).to(metadata.CollapsedSizes,c).easing(TWEEN.Easing.Quintic.In).onUpdate(j).onComplete(function(){return!1}),d=(new TWEEN.Tween(a.numeralSizes)).to(metadata.ExpandedSizes,c).easing(TWEEN.Easing.Quintic.In).onUpdate(j).onComplete(function(){return!1}),c=e=!0,b.chain(d),b.start()};i=function(){var b,c;window.requestAnimationFrame(i,
$("canvas").get(0));TWEEN.update();m||(b=a.display.getCurrentLinkInfo(),$("#crossings").text(b.crossings),$("#subscript").text(b.index),$("#superscript").text(b.numComponents));0===a.pageIndex&&(b=a.display.gallery.links.length,a.mouse.moved&&(c=a.display.height/b,c=Math.floor(a.mouse.position.y/c),c>=b&&(c=null),$("#grasshopper").is(":hover")&&(c=-1),a.display.highlightRow=c),$("#highlight-row").css("visibility","visible"),b=a.display.highlightRow*a.display.height/b,$("#highlight-row").css("top",
b));b=a.display.hotMouse||a.mouse.hot||0===a.pageIndex?"pointer":"";$("#rightpage").css({cursor:b});$("#leftpage").css({cursor:b});a.display.ready&&a.display.render();return a.mouse.moved=!1};l=function(){$(window).resize(function(){return h()});$(document).keydown(function(b){38===b.keyCode&&a.display.moveSelection(0,-1);40===b.keyCode&&a.display.moveSelection(0,1);37===b.keyCode&&a.display.moveSelection(-1,0);39===b.keyCode&&a.display.moveSelection(1,0);32===b.keyCode&&f();if(83===b.keyCode)return n()});
$(".arrow").mouseover(function(){$(this).css("color","#385fa2");return a.mouse.hot=!0});$(".arrow").mouseout(function(){$(this).css({color:""});return a.mouse.hot=!1});$(".arrow").click(function(){return f()});$("#grasshopper").click(function(a){return a.stopPropagation()});$("#wideband").mousemove(function(b){var c;c=$(this).position();a.mouse.position.x=b.clientX-c.left;a.mouse.position.y=b.clientY-c.top;a.mouse.within=1;return a.mouse.moved=!0});$("#wideband").click(function(b){var c;c=$(this).position();
a.mouse.position.x=b.clientX-c.left;a.mouse.position.y=b.clientY-c.top;a.mouse.within=1;a.display.click();0===a.pageIndex&&null==a.swipeTween&&null!=a.display.highlightRow&&(a.display.changeSelection(a.display.gallery.i,a.display.highlightRow),f())});return $("#wideband").mouseout(function(){a.mouse.position.x=-1;a.mouse.position.y=-1;return a.mouse.within=!1})};n=function(){var b;b=$("canvas").get(0);a.display.render();b=b.toDataURL("image/png");window.open(b,"_blank");return window.focus()};j=function(){$("#crossings").css("font-size",
a.numeralSizes.crossings);$("#superscript").css("font-size",a.numeralSizes.numComponents);return $("#subscript").css("font-size",a.numeralSizes.index)};g=function(a){var c;c=parseInt($("#canvaspage").css("width"));return 1===a?0:c};k=function(){var b;b=parseInt($("#canvaspage").css("width"));parseInt($("#canvaspage").css("height"));$("#leftpage").css("left",-b+a.pan.x);$("#leftpage").css("width",b);$("#rightpage").css("left",0+a.pan.x);return $("#rightpage").css("width",b)};h=function(){var b,c,d;
c=parseInt($("#wideband").css("height"));d=768*c/1024;$("#wideband").css("width",d);b=parseInt($("body").css("width"));$("#wideband").css("left",b/2-d/2);d=parseInt($("#canvaspage").css("width"));null!=a.swipeTween&&a.swipeTween.stop();c=parseInt($("#canvaspage").css("height"));b=$("canvas").get(0);b.clientWidth=d;b.width=b.clientWidth;b.clientHeight=c;b.height=b.clientHeight;a.display.width=d;a.display.height=c;a.pan.x=g(a.pageIndex);return k()};f=function(){var b;if(null==a.swipeTween)return a.pageIndex=
1-a.pageIndex,b=g(a.pageIndex),a.swipeTween=(new TWEEN.Tween(a.pan)).to({x:b},1E3).easing(TWEEN.Easing.Bounce.Out).onUpdate(k).onComplete(function(){return a.swipeTween=null}),a.swipeTween.start()};a.pageIndex=1;a.pan={x:0};a.mouse={position:{x:-1,y:-1},within:!1,hot:!1,moved:!1};a.numeralSizes=utility.clone(metadata.ExpandedSizes);m=!1}).call(this);
