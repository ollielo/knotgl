(function(){var r,i,d,j,s,l,m,h,e,c,k,g,n,p,q;c="undefined"!==typeof exports&&null!==exports?exports:this;i=j=!1;g=d=null;h=utility.clone(metadata.ExpandedSizes);e=window.devicePixelRatio||1;$(document).ready(function(){var a,b,f,g;try{if(a=$("canvas").get(0),b=a.getContext("experimental-webgl",{antialias:!0}),!b)throw Error();}catch(h){$("canvas").replaceWith("<p>Your browser does not support WebGL.</p>")}b&&(g=e*parseInt($("#overlay").css("width")),f=e*parseInt($("#overlay").css("height")),d=new c.Display(b,
g,f));m();r();return window.requestAnimationFrame(n,a)});c.StartNumeralAnimation=function(){var a,b;if(!i&&!j)return b=0.25*d.transitionMilliseconds,a=(new TWEEN.Tween(h)).to(metadata.CollapsedSizes,b).easing(TWEEN.Easing.Quintic.In).onUpdate(p).onComplete(function(){return i=!1}),b=(new TWEEN.Tween(h)).to(metadata.ExpandedSizes,b).easing(TWEEN.Easing.Quintic.In).onUpdate(p).onComplete(function(){return j=!1}),i=j=!0,a.chain(b),a.start()};n=function(){var a,b;window.requestAnimationFrame(n,$("canvas").get(0));
TWEEN.update();i||(a=d.getCurrentLinkInfo(),$("#crossings").text(a.crossings),$("#subscript").text(a.index),$("#superscript").text(a.numComponents));0===c.pageIndex&&(a=d.gallery.links.length,c.mouse.moved&&(b=d.height/a,b=Math.floor(c.mouse.position.y/b),b>=a&&(b=null),$("#grasshopper").is(":hover")&&(b=-1),d.highlightRow=b),$("#highlight-row").css("visibility","visible"),a=d.highlightRow*d.height/(a*e),$("#highlight-row").css("top",a));a=d.hotMouse||c.mouse.hot||0===c.pageIndex?"pointer":"";$("#rightpage").css({cursor:a});
$("#leftpage").css({cursor:a});d.ready&&d.render();return c.mouse.moved=!1};r=function(){$(window).resize(function(){return m()});$(document).keydown(function(a){38===a.keyCode&&d.moveSelection(0,-1);40===a.keyCode&&d.moveSelection(0,1);37===a.keyCode&&d.moveSelection(-1,0);39===a.keyCode&&d.moveSelection(1,0);32===a.keyCode&&k();if(83===a.keyCode)return s()});$(".arrow").mouseover(function(){$(this).css("color","#385fa2");return c.mouse.hot=!0});$(".arrow").mouseout(function(){$(this).css({color:""});
return c.mouse.hot=!1});$(".arrow").click(function(){return k()});$("#grasshopper").click(function(a){return a.stopPropagation()});$("#wideband").mousemove(function(a){var b,d;b=$(this).position();d=a.clientX-b.left;a=a.clientY-b.top;c.mouse.position.x=d*e;c.mouse.position.y=a*e;c.mouse.within=1;return c.mouse.moved=!0});$("#wideband").click(function(a){var b,f;b=$(this).position();f=a.clientX-b.left;a=a.clientY-b.top;c.mouse.position.x=f*e;c.mouse.position.y=a*e;c.mouse.within=1;d.click();0===c.pageIndex&&
null==g&&null!=d.highlightRow&&(d.changeSelection(d.gallery.i,d.highlightRow),k())});return $("#wideband").mouseout(function(){c.mouse.position.x=-1;c.mouse.position.y=-1;return c.mouse.within=!1})};s=function(){var a;a=$("canvas").get(0);d.render();a=a.toDataURL("image/png");window.open(a,"_blank");return window.focus()};p=function(){$("#crossings").css("font-size",h.crossings);$("#superscript").css("font-size",h.numComponents);return $("#subscript").css("font-size",h.index)};l=function(a){var b;
b=parseInt($("#canvaspage").css("width"));return 1===a?0:b};q=function(){var a;a=parseInt($("#canvaspage").css("width"));$("#leftpage").css("left",-a+c.pan.x);$("#leftpage").css("width",a);$("#rightpage").css("left",0+c.pan.x);return $("#rightpage").css("width",a)};m=function(){var a,b,f;b=parseInt($("#wideband").css("height"));f=768*b/1024;$("#wideband").css("width",f);a=parseInt($("body").css("width"));$("#wideband").css("left",a/2-f/2);f=parseInt($("#canvaspage").css("width"));null!=g&&g.stop();
b=parseInt($("#canvaspage").css("height"));if(a=$("canvas").get(0))return a.clientWidth=f,a.width=a.clientWidth*e,a.clientHeight=b,a.height=a.clientHeight*e,d.width=f*e,d.height=b*e,c.pan.x=l(c.pageIndex),q()};k=function(){var a;if(null==g)return c.pageIndex=1-c.pageIndex,a=l(c.pageIndex),g=(new TWEEN.Tween(c.pan)).to({x:a},1E3).easing(TWEEN.Easing.Bounce.Out).onUpdate(q).onComplete(function(){return g=null}),g.start()};c.pixelRatio=e;c.pageIndex=1;c.pan={x:0};c.mouse={position:{x:-1,y:-1},within:!1,
hot:!1,moved:!1}}).call(this);
