(function(){var e,n,f,g,o,i,j,b,h,k,l,m;b="undefined"!==typeof exports&&null!==exports?exports:this;b.pageIndex=1;b.pan={x:0};b.mouse={position:{x:-1,y:-1},within:!1,hot:!1,moved:!1};e=utility.clone(metadata.ExpandedSizes);f=g=!1;$(function(){var a,c,d,e;a=$("canvas").get(0);c=a.getContext("experimental-webgl",{antialias:!0});c.getExtension("OES_texture_float")||glerr("Your browser does not support floating-point textures.");c.getExtension("OES_standard_derivatives")||glerr("Your browser does not support GLSL derivatives.");
e=parseInt($("#overlay").css("width"));d=parseInt($("#overlay").css("height"));b.display=new b.Display(c,e,d);j();n();return window.requestAnimationFrame(k,a)});b.AnimateNumerals=function(){var a,c;if(!f&&!g)return c=0.25*b.display.transitionMilliseconds,a=(new TWEEN.Tween(e)).to(metadata.CollapsedSizes,c).easing(TWEEN.Easing.Quintic.In).onUpdate(l).onComplete(function(){return f=!1}),c=(new TWEEN.Tween(e)).to(metadata.ExpandedSizes,c).easing(TWEEN.Easing.Quintic.In).onUpdate(l).onComplete(function(){return g=
!1}),f=g=!0,a.chain(c),a.start()};k=function(){var a,c,d;d=b.display;window.requestAnimationFrame(k,$("canvas").get(0));TWEEN.update();f||(a=d.getCurrentLinkInfo(),$("#crossings").text(a.crossings),$("#subscript").text(a.index),$("#superscript").text(a.numComponents));0===b.pageIndex&&(a=d.gallery.links.length,b.mouse.moved&&(c=d.height/a,c=Math.floor(b.mouse.position.y/c),c>=a&&(c=null),$("#grasshopper").is(":hover")&&(c=-1),d.highlightRow=c),$("#highlight-row").css("visibility","visible"),a=d.highlightRow*
d.height/a,$("#highlight-row").css("top",a));a=b.display.hotMouse||b.mouse.hot||0===b.pageIndex?"pointer":"";$("#rightpage").css({cursor:a});$("#leftpage").css({cursor:a});d.ready&&d.render();return b.mouse.moved=!1};n=function(){$(window).resize(function(){return j()});$(document).keydown(function(a){38===a.keyCode&&b.display.moveSelection(0,-1);40===a.keyCode&&b.display.moveSelection(0,1);37===a.keyCode&&b.display.moveSelection(-1,0);39===a.keyCode&&b.display.moveSelection(1,0);32===a.keyCode&&
h();if(83===a.keyCode)return o()});$(".arrow").mouseover(function(){$(this).css("color","#385fa2");return b.mouse.hot=!0});$(".arrow").mouseout(function(){$(this).css({color:""});return b.mouse.hot=!1});$(".arrow").click(function(){return h()});$("#grasshopper").click(function(a){return a.stopPropagation()});$("#wideband").mousemove(function(a){var c;c=$(this).position();b.mouse.position.x=a.clientX-c.left;b.mouse.position.y=a.clientY-c.top;b.mouse.within=1;return b.mouse.moved=!0});$("#wideband").click(function(a){var c;
c=$(this).position();b.mouse.position.x=a.clientX-c.left;b.mouse.position.y=a.clientY-c.top;b.mouse.within=1;display.click();0===b.pageIndex&&null==b.swipeTween&&(a=b.display,null!=a.highlightRow&&(a.changeSelection(a.gallery.i,a.highlightRow),h()))});return $("#wideband").mouseout(function(){b.mouse.position.x=-1;b.mouse.position.y=-1;return b.mouse.within=!1})};o=function(){var a;a=$("canvas").get(0);b.display.render();a=a.toDataURL("image/png");window.open(a,"_blank");return window.focus()};l=
function(){$("#crossings").css("font-size",e.crossings);$("#superscript").css("font-size",e.numComponents);return $("#subscript").css("font-size",e.index)};i=function(a){var b;b=parseInt($("#canvaspage").css("width"));return 1===a?0:b};m=function(){var a;a=parseInt($("#canvaspage").css("width"));parseInt($("#canvaspage").css("height"));$("#leftpage").css("left",-a+b.pan.x);$("#leftpage").css("width",a);$("#rightpage").css("left",0+b.pan.x);return $("#rightpage").css("width",a)};j=function(){var a,
c,d;c=parseInt($("#wideband").css("height"));d=768*c/1024;$("#wideband").css("width",d);a=parseInt($("body").css("width"));$("#wideband").css("left",a/2-d/2);d=parseInt($("#canvaspage").css("width"));null!=b.swipeTween&&b.swipeTween.stop();c=parseInt($("#canvaspage").css("height"));a=$("canvas").get(0);a.clientWidth=d;a.width=a.clientWidth;a.clientHeight=c;a.height=a.clientHeight;this.display.width=d;this.display.height=c;b.pan.x=i(b.pageIndex);return m()};h=function(){var a;if(null==b.swipeTween)return b.pageIndex=
1-b.pageIndex,a=i(b.pageIndex),b.swipeTween=(new TWEEN.Tween(b.pan)).to({x:a},1E3).easing(TWEEN.Easing.Bounce.Out).onUpdate(m).onComplete(function(){return b.swipeTween=null}),b.swipeTween.start()}}).call(this);
